<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>watch와 watchEffect의 차이 | ChangJoo Park&#39;s Write</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/write/assets/css/0.styles.c3a3c9ce.css" as="style"><link rel="preload" href="/write/assets/js/app.88076934.js" as="script"><link rel="preload" href="/write/assets/js/2.62d75d41.js" as="script"><link rel="preload" href="/write/assets/js/33.6ea00d29.js" as="script"><link rel="prefetch" href="/write/assets/js/10.233b49c4.js"><link rel="prefetch" href="/write/assets/js/11.49ce2064.js"><link rel="prefetch" href="/write/assets/js/12.e6b6a916.js"><link rel="prefetch" href="/write/assets/js/13.33bec535.js"><link rel="prefetch" href="/write/assets/js/14.f67c9dbb.js"><link rel="prefetch" href="/write/assets/js/15.eab5b590.js"><link rel="prefetch" href="/write/assets/js/16.2e0e0242.js"><link rel="prefetch" href="/write/assets/js/17.778ed87a.js"><link rel="prefetch" href="/write/assets/js/18.50762327.js"><link rel="prefetch" href="/write/assets/js/19.a4fee796.js"><link rel="prefetch" href="/write/assets/js/20.280c1dc4.js"><link rel="prefetch" href="/write/assets/js/21.dffd91a4.js"><link rel="prefetch" href="/write/assets/js/22.34715d61.js"><link rel="prefetch" href="/write/assets/js/23.1132ce43.js"><link rel="prefetch" href="/write/assets/js/24.4251af93.js"><link rel="prefetch" href="/write/assets/js/25.a03a3d4f.js"><link rel="prefetch" href="/write/assets/js/26.ca9a2e28.js"><link rel="prefetch" href="/write/assets/js/27.fd0e6a79.js"><link rel="prefetch" href="/write/assets/js/28.064f18b6.js"><link rel="prefetch" href="/write/assets/js/29.ba6eb953.js"><link rel="prefetch" href="/write/assets/js/3.ee451ee8.js"><link rel="prefetch" href="/write/assets/js/30.7f5a92a6.js"><link rel="prefetch" href="/write/assets/js/31.d9920ec4.js"><link rel="prefetch" href="/write/assets/js/32.4d0eeb72.js"><link rel="prefetch" href="/write/assets/js/34.ffeb8668.js"><link rel="prefetch" href="/write/assets/js/4.ca167eb3.js"><link rel="prefetch" href="/write/assets/js/5.c895731a.js"><link rel="prefetch" href="/write/assets/js/6.f93936eb.js"><link rel="prefetch" href="/write/assets/js/7.e9c1f144.js"><link rel="prefetch" href="/write/assets/js/8.bd035fcc.js"><link rel="prefetch" href="/write/assets/js/9.00082ab0.js">
    <link rel="stylesheet" href="/write/assets/css/0.styles.c3a3c9ce.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/write/" class="home-link router-link-active"><!----> <span class="site-name">ChangJoo Park's Write</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/write/guide/" class="nav-link router-link-active">
  가이드
</a></div><div class="nav-item"><a href="https://github.com/changjoo-park/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://medium.com/@changjoopark/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Medium
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/write/guide/" class="nav-link router-link-active">
  가이드
</a></div><div class="nav-item"><a href="https://github.com/changjoo-park/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://medium.com/@changjoopark/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Medium
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Vue.js</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/write/guide/vue/" aria-current="page" class="sidebar-link">소개</a></li><li><a href="/write/guide/vue/composition-api.html" class="sidebar-link">처음 만나는 Composition API</a></li><li><a href="/write/guide/vue/difference-between-ref-and-reactive.html" class="sidebar-link">ref 와 reactive는 어떻게 다른가</a></li><li><a href="/write/guide/vue/performance-ref-reactive.html" class="sidebar-link">ref 와 reactive의 성능차이</a></li><li><a href="/write/guide/vue/watch-watch-effect.html" aria-current="page" class="active sidebar-link">watch와 watchEffect의 차이</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/write/guide/vue/watch-watch-effect.html#사이드이펙트" class="sidebar-link">사이드이펙트</a></li></ul></li><li><a href="/write/guide/vue/debugging-vue.html" class="sidebar-link">Vue 앱 디버깅</a></li><li><a href="/write/guide/vue/devtools.html" class="sidebar-link">Vue.js 3 개발자도구 (devtools)</a></li><li><a href="/write/guide/vue/composition-api-to-three.html" class="sidebar-link">Composition API 에서 Vue 3</a></li><li><a href="/write/guide/vue/prototype-to-global-properties.html" class="sidebar-link">글로벌 속성 주입 방식 변경</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Nuxt</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Deno</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Flutter</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="watch와-watcheffect의-차이"><a href="#watch와-watcheffect의-차이" class="header-anchor">#</a> watch와 watchEffect의 차이</h1> <p>Vue.js 3은 <code>watch</code> 외에 <code>watchEffect</code> 가 추가되었습니다. 두 키워드 모두 반응성을 가진 데이터 변경을 감지하는데 사용합니다.
큰 차이점은 다음과 같습니다.</p> <ul><li>watch는 이전값, 현재값 모두 필요한 경우 사용합니다.</li> <li>watchEffect는 현재값만 필요할 때 사용합니다.</li> <li>watchEffect는 감시하는 대상을 명시적으로 지정하지 않습니다.</li> <li>watchEffect는 watchEffect에 전달하는 콜백 메소드 안에 반응성을 가진 데이터를 사용하는 경우에만 호출됩니다.</li></ul> <p>테스트를 위한 예제입니다. <code>watch</code> 1개와 <code>watchEffect</code> 3개를 만들었습니다.</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>{{ count }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>{{ count2 }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>count = Math.random()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>change<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>count2 = Math.random()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>change<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> watch<span class="token punctuation">,</span> watchEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> count2 <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token comment">// count가 변화될 때 이전/현재 값을 사용할 수 있습니다.</span>
    <span class="token function">watch</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">current<span class="token punctuation">,</span> previous</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'[count] watch =&gt; '</span><span class="token punctuation">,</span> current<span class="token punctuation">,</span> previous<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// count 또는 count2가 변경되는 경우 호출됩니다.</span>
    <span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'[count, count2] watchEffect'</span><span class="token punctuation">,</span> count<span class="token punctuation">.</span>value<span class="token punctuation">,</span> count2<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// count가 변경될 때 호출됩니다.</span>
    <span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'[count] watchEffect'</span><span class="token punctuation">,</span> count<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// count2가 변경될 때 호출됩니다.</span>
    <span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'[count2] watchEffect'</span><span class="token punctuation">,</span> count2<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> count<span class="token punctuation">,</span> count2 <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>각 시점별 출력된 로그입니다.</p> <p>컴포넌트가 등록될 때</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">[</span>count, count2<span class="token punctuation">]</span> watchEffect <span class="token number">0</span> <span class="token number">1</span>
<span class="token punctuation">[</span>count<span class="token punctuation">]</span> watchEffect <span class="token number">0</span>
<span class="token punctuation">[</span>count2<span class="token punctuation">]</span> watchEffect <span class="token number">1</span>
</code></pre></div><p>count가 변경될 때</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">[</span>count<span class="token punctuation">]</span> <span class="token function">watch</span> <span class="token operator">=</span><span class="token operator">&gt;</span>  <span class="token number">0.16419505711416238</span> <span class="token number">0</span>
<span class="token punctuation">[</span>count, count2<span class="token punctuation">]</span> watchEffect <span class="token number">0.16419505711416238</span> <span class="token number">1</span>
<span class="token punctuation">[</span>count<span class="token punctuation">]</span> watchEffect <span class="token number">0.16419505711416238</span>
</code></pre></div><p>count2가 변경될 때</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">[</span>count, count2<span class="token punctuation">]</span> watchEffect <span class="token number">0</span> <span class="token number">0.7238270105035622</span>
<span class="token punctuation">[</span>count2<span class="token punctuation">]</span> watchEffect <span class="token number">0.7238270105035622</span>
</code></pre></div><h2 id="사이드이펙트"><a href="#사이드이펙트" class="header-anchor">#</a> 사이드이펙트</h2> <p><code>watchEffect</code> 는 반응성을 가진 데이터가 만들어질 때에도 호출됩니다. 이름에 &quot;effect&quot; 가 붙은 것 처럼 반응성 데이터가 만들어질때의 &quot;사이드이펙트&quot; 도 감지합니다.
Vue.js 3은 <code>ref</code>와 <code>reactive</code> 가 만들어내는 <code>ReactiveEffect</code> 라는 사이드이펙트를 만들어냅니다. 이 사이드이펙트는 <code>effectStack</code> 에서 관리됩니다.</p> <p><code>ref</code> 와 <code>reactive</code> 는 값이 변화되는 마지막 시점에 <a href="https://github.com/vuejs/vue-next/blob/376883d1cfea6ed92807cce1f1209f943a04b625/packages/reactivity/src/effect.ts#L165-L255" target="_blank" rel="noopener noreferrer">trigger<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 를 호출합니다.
이것으로 반응성 데이터 조작의 &quot;사이드이펙트&quot; 를 발생시킵니다. 발생한 &quot;사이드이펙트&quot; 는 <a href="https://github.com/vuejs/vue-next/blob/376883d1cfea6ed92807cce1f1209f943a04b625/packages/runtime-core/src/apiWatch.ts#L133-L314" target="_blank" rel="noopener noreferrer">doWatch<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 에서 처리됩니다.</p> <p><code>watchEffect</code> 는 <code>watch</code> 구현의 최소화 버전입니다. <code>watch</code> 는 반응성을 가지는 데이터의 이전, 이후값에 대한 타입 체크 및 상태를 확인 한 다음 처리하는 반면 <code>watchEffect</code> 는 사이드이펙트 발생 여부만 사용합니다.</p> <p>추가로 <code>ReactiveEffect</code> 는 아래와 같은 추가 옵션과 핸들러를 가지고 있습니다. 이 장에서 자세히 다루지 않습니다.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ReactiveEffectOptions</span> <span class="token punctuation">{</span>
  lazy<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>
  scheduler<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>job<span class="token operator">:</span> ReactiveEffect<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>
  onTrack<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>event<span class="token operator">:</span> DebuggerEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>
  onTrigger<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>event<span class="token operator">:</span> DebuggerEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>
  onStop<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>
  allowRecurse<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/write/guide/vue/performance-ref-reactive.html" class="prev">
        ref 와 reactive의 성능차이
      </a></span> <span class="next"><a href="/write/guide/vue/debugging-vue.html">
        Vue 앱 디버깅
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/write/assets/js/app.88076934.js" defer></script><script src="/write/assets/js/2.62d75d41.js" defer></script><script src="/write/assets/js/33.6ea00d29.js" defer></script>
  </body>
</html>
